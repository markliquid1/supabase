<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fleet Leaderboards</title>
    <link rel="stylesheet" href="styles2.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <div class="container" style="background: transparent; box-shadow: none; padding: 0; max-width: none;">
        <div class="settings-card" style="box-shadow: none; padding: 0; margin: 0;">

            <!-- Exploration & Adventure -->
            <div class="section-title">Exploration & Adventure</div>
            <div class="leaderboards-container">
                
                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Countries Visited</div>
                    <div class="leaderboard" id="lb-countries-visited"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Ports Visited</div>
                    <div class="leaderboard" id="lb-ports-visited"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Total Distance</div>
                    <div class="leaderboard" id="lb-total-distance"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Longest Trip Without Stopping</div>
                    <div class="leaderboard" id="lb-longest-trip"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Most Distance in 24hrs</div>
                    <div class="leaderboard" id="lb-max-24hr"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Total Days Cruising</div>
                    <div class="leaderboard" id="lb-days-cruising"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Longest Passage (Days)</div>
                    <div class="leaderboard" id="lb-longest-passage"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Days Cruising This Year</div>
                    <div class="leaderboard" id="lb-days-this-year"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Consecutive Days Under Sail</div>
                    <div class="leaderboard" id="lb-consecutive-sail"></div>
                </div>

            </div>

            <!-- Energy & Efficiency -->
            <div class="section-title">Energy & Efficiency</div>
            <div class="leaderboards-container">
                
                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Solar kWh</div>
                    <div class="leaderboard" id="lb-solar-kwh"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Alternator kWh</div>
                    <div class="leaderboard" id="lb-alt-kwh"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Max Alternator Output</div>
                    <div class="leaderboard" id="lb-max-alt-amps"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Best nM per Gallon</div>
                    <div class="leaderboard" id="lb-nm-per-gallon"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Best nM per kWh</div>
                    <div class="leaderboard" id="lb-nm-per-kwh"></div>
                </div>

            </div>

            <!-- Speed Records -->
            <div class="section-title">Speed Records</div>
            <div class="speed-chart-container">
                <div class="speed-chart-title">Sustained Speed Records</div>
                <div class="speed-filter-controls">
                    <label>
                        <input type="radio" name="speedFilter" value="overall" checked>
                        Overall
                    </label>
                    <label>
                        <input type="radio" name="speedFilter" value="sailboat">
                        Sailboats
                    </label>
                    <label>
                        <input type="radio" name="speedFilter" value="catamaran">
                        Catamarans
                    </label>
                    <label>
                        <input type="radio" name="speedFilter" value="powerboat">
                        Powerboats
                    </label>
                    <label>
                        <input type="radio" name="speedFilter" value="trawler">
                        Trawlers
                    </label>
                </div>
                <canvas id="speedChart" width="400" height="360"></canvas>
                <div class="speed-legend">
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #0066cc; box-shadow: 0 0 8px rgba(0,102,204,0.6);"></div>
                        <span>Your boat</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: rgba(100,100,100,0.4);"></div>
                        <span>Top performers</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: rgba(100,100,100,0.2);"></div>
                        <span>Other boats</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-line"></div>
                        <span>Expected hull speed</span>
                    </div>
                </div>
            </div>

            <!-- Engine & Maintenance -->
            <div class="section-title">Engine & Maintenance</div>
            <div class="leaderboards-container">
                
                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Total Engine Hours</div>
                    <div class="leaderboard" id="lb-engine-hours"></div>
                </div>

            </div>

            <!-- Weather Extremes -->
            <div class="section-title">Weather Extremes</div>
            <div class="leaderboards-container">
                
                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Highest Board Temperature</div>
                    <div class="leaderboard" id="lb-max-temp"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Lowest Board Temperature</div>
                    <div class="leaderboard" id="lb-min-temp"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Highest Barometric Pressure</div>
                    <div class="leaderboard" id="lb-max-pressure"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Lowest Barometric Pressure</div>
                    <div class="leaderboard" id="lb-min-pressure"></div>
                </div>

            </div>

            <!-- Anchoring -->
            <div class="section-title">Anchoring</div>
            <div class="leaderboards-container">
                
                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Deepest Anchorage</div>
                    <div class="leaderboard" id="lb-deepest-anchorage"></div>
                </div>

                <div class="leaderboard-wrapper">
                    <div class="leaderboard-header">Consecutive Days at Anchor</div>
                    <div class="leaderboard" id="lb-consecutive-anchor"></div>
                </div>

            </div>

            <p style="margin-top: 30px; font-size: 13px; color: #888;">
                There will be lag in Leaderboard updates to ensure accuracy, 24hrs in cases like "days at sea". Your
                entry is highlighted in blue.
            </p>
        </div>
    </div>

    <div class="tooltip" id="speedTooltip"></div>

    <script src="leaderboards_new.js"></script>
    <script>
        // Iframe height reporting for parent page
        (function () {
            function sendHeight() {
                const doc = document.documentElement;
                const body = document.body;
                const height = Math.max(
                    doc.scrollHeight, doc.offsetHeight,
                    body ? body.scrollHeight : 0,
                    body ? body.offsetHeight : 0
                );
                window.parent.postMessage({ type: "IFRAME_HEIGHT", height }, "*");
            }

            sendHeight();

            const ro = new ResizeObserver(() => sendHeight());
            ro.observe(document.documentElement);
            if (document.body) ro.observe(document.body);

            window.addEventListener("message", (e) => {
                if (e.data && e.data.type === "REQ_IFRAME_HEIGHT") sendHeight();
            });

            if (document.fonts && document.fonts.ready) {
                document.fonts.ready.then(sendHeight).catch(() => { });
            }
        })();
    </script>
</body>

</html>
